<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
	    <title></title>
 
	    <%= raw(@font_link_data) %>

		<%= stylesheet_link_tag    "online_site" %>
		<%= javascript_include_tag "application" %>

		<script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDmVdO0hER_qFFNZN5C9Du28_-sSblng0Y&sensor=true"></script>	
		<!--[if lt IE 9]>
			<script src="https://css3-mediaqueries-js.googlecode.com/files/css3-mediaqueries.js"></script>
			<script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->	
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, minimal-ui" />		
	</head>

	<style>

		<%= raw(@design_css) %>
		<%= raw(@design_menu_css) %>
		<%= raw(@font_css) %>

	</style>

    <body>
		<div class="overlay"></div>  
		<nav id="navigation_small" class="nav">
			<ul>
				<li class="icon" data-bind="click: display_menu_toggle"><i class="fa fa-bars"></i></li>
				<!-- ko if: display_menu -->
					<li><a data-bind="click: function() { goto_and_kill_menu('start') }">Home</a></li>
					<li><a data-bind="click: function() { goto_and_kill_menu('menu') }">Menu</a></li>
					<li><a data-bind="click: function() { goto_and_kill_menu('contact') }">Contact</a></li>
				<!-- /ko -->
			</ul>
		</nav>			  	
		<div id="left_menu">
			<h3 class="restaurant_name">Tuckshop</h3>
			<nav id="navigation" class="nav">
				<ul>
					<li><a data-bind="page-href: 'start'">Home</a></li>
					<li><a data-bind="page-href: 'menu'">Menu</a></li>
					<li><a data-bind="page-href: 'contact'">Contact</a></li>
				</ul>
			</nav>	
			<div id="social_media" class="social_media" data-bind="with: restaurant">
				<a data-bind="visible: socialVisible('facebook'), attr:{href: facebook}"><i class="fa fa-facebook-square"></i></a>
				<a data-bind="visible: socialVisible('twitter'), attr:{href: twitter}"><i class="fa fa-twitter-square"></i></a>			
				<a data-bind="visible: socialVisible('instagram'), attr:{href: instagram}"><i class="fa fa-instagram"></i></a>
			</div>			
		</div>
		<div data-bind="style:{backgroundImage: $root.computeImage('header_background_pattern')}" id="left_menu_background"></div>

		<div id="footer">
			<div id="social_media_footer" class="social_media" data-bind="with: restaurant">
				<a data-bind="visible: socialVisible('facebook'), attr:{href: facebook}"><i class="fa fa-facebook-square"></i></a>
				<a data-bind="visible: socialVisible('twitter'), attr:{href: twitter}"><i class="fa fa-twitter-square"></i></a>			
				<a data-bind="visible: socialVisible('instagram'), attr:{href: instagram}"><i class="fa fa-instagram"></i></a>
			</div>	
		</div>

		<div data-bind="style:{backgroundImage: $root.computeImage('header_background_pattern')}" id="footer_background"></div>	

		<div data-bind="page: {id: 'start', title: 'Tuckshop'}" class="pages">
			<div id="content_wrapper">
				<div id="content">					
					<%= render 'start' %>
				</div>			
			</div>							
		</div>	
		<div data-bind="page: {id: 'contact', title: 'Contact Tuckshop'}" class="pages">
			<div id="content_wrapper">
				<div id="content">					
					<%= render 'contact' %>
				</div>			
			</div>														
		</div>


		<div data-bind="page: {id: 'menu', title: 'Menu'}" class="pages">
			<%= yield %>
		</div>	

    	<%= javascript_include_tag "menu_editor" %>

		<%= render 'shared/design_javascript' %>
		<%= render 'shared/restaurant_javascript' %>

		<script type="text/javascript">

	        var restaurant_id = "<%= params[:restaurant_id]%>";
	        var menu_data = <%= raw(@menu_data) %>;
	        var design_data = <%= raw(@design_data.to_json) %>;
	        var resto_data = <%= raw(@resto_data.to_json) %>;	
	        var background_images = <%= raw(@carousel.to_json) %>;

			$(function(){
			        $.mbBgndGallery.buildGallery({
			                containment:"body",
			                timer:4000,
			                effTimer:2000,
			                grayScale:false,
			                images: background_images,

			                onStart:function(){},
			                onPause:function(){},
			                onPlay:function(opt){},
			                onChange:function(idx){}, //idx=the zero based index of the displayed photo
			                onNext:function(opt){},   //opt=the options relatives to this component instance
			                onPrev:function(opt){}   //opt=the options relatives to this component instance
			        });
			})

	        editing_mode = false;    
	        var viewmodel = new PublicMenuModel();

	        $("#menu-toggle").click(function(e) {
	            e.preventDefault();
	            $("#wrapper").toggleClass("active");
	        });			

        	$(function(){	
        		pager.Href.hash = '#!/';
				pager.extendWithPage(viewmodel);
	        	ko.applyBindings(viewmodel);        			
				pager.start();			
			});

			function initialize() {
				var myLatlng = new google.maps.LatLng(-25.363882,131.044922);
				var mapOptions = {
					center: myLatlng,
					zoom: 12
				};			
				var map = new google.maps.Map(document.getElementById("map-canvas"),mapOptions);
				var marker = new google.maps.Marker({
					position: myLatlng,
					map: map,
					title: 'Hello World!'
				});					
			}
			google.maps.event.addDomListener(window, 'load', initialize);

			function showModal(page, callback) {
				$(page.element).modal('show');
			};
			function hideModal(page, callback) {
				$(page.element).modal('hide');
			};			

        </script>

    </body>
</html>
