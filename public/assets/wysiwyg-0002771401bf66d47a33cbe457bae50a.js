!function(t){"function"==typeof define&&define.amd?define(["jquery","codemirror"],t):t(window.jQuery,window.CodeMirror)}(function(t,e){"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(t,e){var n,a,o=this.length>>>0,i=!1;for(1<arguments.length&&(a=e,i=!0),n=0;o>n;++n)this.hasOwnProperty(n)&&(i?a=t(a,this[n],n,this):(a=this[n],i=!0));if(!i)throw new TypeError("Reduce of empty array with no initial value");return a});var n={bMac:navigator.appVersion.indexOf("Mac")>-1,bMSIE:navigator.userAgent.indexOf("MSIE")>-1,bFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(t.fn.jquery),bCodeMirror:!!e},a=function(){var t=function(t){return function(e){return t===e}},e=function(t,e){return t===e},n=function(){return!0},a=function(){return!1},o=function(t){return function(){return!t.apply(t,arguments)}},i=function(t){return t};return{eq:t,eq2:e,ok:n,fail:a,not:o,self:i}}(),o=function(){var t=function(t){return t[0]},e=function(t){return t[t.length-1]},n=function(t){return t.slice(0,t.length-1)},o=function(t){return t.slice(1)},i=function(t,e){var n=t.indexOf(e);return-1===n?null:t[n+1]},r=function(t,e){var n=t.indexOf(e);return-1===n?null:t[n-1]},l=function(t,e){return e=e||a.self,t.reduce(function(t,n){return t+e(n)},0)},s=function(t){for(var e=[],n=-1,a=t.length;++n<a;)e[n]=t[n];return e},d=function(n,a){if(0===n.length)return[];var i=o(n);return i.reduce(function(t,n){var o=e(t);return a(e(o),n)?o[o.length]=n:t[t.length]=[n],t},[[t(n)]])},c=function(t){for(var e=[],n=0,a=t.length;a>n;n++)t[n]&&e.push(t[n]);return e};return{head:t,last:e,initial:n,tail:o,prev:r,next:i,sum:l,from:s,compact:c,clusterBy:d}}(),i=function(){var e=function(e){return e&&t(e).hasClass("note-editable")},r=function(e){return e&&t(e).hasClass("note-control-sizing")},l=function(t){var e=function(e){return function(){return t.find(e)}};return{editor:function(){return t},dropzone:e(".note-dropzone"),toolbar:e(".note-toolbar"),editable:e(".note-editable"),codable:e(".note-codable"),statusbar:e(".note-statusbar"),popover:e(".note-popover"),handle:e(".note-handle"),dialog:e(".note-dialog")}},s=function(t){return function(e){return e&&e.nodeName===t}},d=function(t){return t&&/^DIV|^P|^LI|^H[1-7]/.test(t.nodeName)},c=function(t){return t&&/^UL|^OL/.test(t.nodeName)},u=function(t){return t&&/^TD|^TH/.test(t.nodeName)},f=function(t,n){for(;t;){if(n(t))return t;if(e(t))break;t=t.parentNode}return null},h=function(t,e){e=e||a.fail;var n=[];return f(t,function(t){return n.push(t),e(t)}),n},p=function(e,n){for(var a=h(e),o=n;o;o=o.parentNode)if(t.inArray(o,a)>-1)return o;return null},v=function(t,e){var n=[],a=!1,o=!1;return function i(r){if(r){if(r===t&&(a=!0),a&&!o&&n.push(r),r===e)return void(o=!0);for(var l=0,s=r.childNodes.length;s>l;l++)i(r.childNodes[l])}}(p(t,e)),n},b=function(t,e){e=e||a.fail;for(var n=[];t&&(n.push(t),!e(t));)t=t.previousSibling;return n},g=function(t,e){e=e||a.fail;for(var n=[];t&&(n.push(t),!e(t));)t=t.nextSibling;return n},m=function(t,e){var n=[];return e=e||a.ok,function o(a){t!==a&&e(a)&&n.push(a);for(var i=0,r=a.childNodes.length;r>i;i++)o(a.childNodes[i])}(t),n},k=function(t,e){var n=e.nextSibling,a=e.parentNode;return n?a.insertBefore(t,n):a.appendChild(t),t},y=function(e,n){return t.each(n,function(t,n){e.appendChild(n)}),e},w=s("#text"),C=function(t){return w(t)?t.nodeValue.length:t.childNodes.length},x=function(t){for(var e=0;t=t.previousSibling;)e+=1;return e},T=function(e,n){var i=o.initial(h(n,a.eq(e)));return t.map(i,x).reverse()},S=function(t,e){for(var n=t,a=0,o=e.length;o>a;a++)n=n.childNodes[e[a]];return n},F=function(t,e){if(0===e)return t;if(e>=C(t))return t.nextSibling;if(w(t))return t.splitText(e);var n=t.childNodes[e];return t=k(t.cloneNode(!1),t),y(t,g(n))},I=function(t,e,n){var o=h(e,a.eq(t));return 1===o.length?F(e,n):o.reduce(function(t,a){var o=a.cloneNode(!1);return k(o,a),t===e&&(t=F(t,n)),y(o,g(t)),o})},M=function(t,e){if(t&&t.parentNode){if(t.removeNode)return t.removeNode(e);var n=t.parentNode;if(!e){var a,o,i=[];for(a=0,o=t.childNodes.length;o>a;a++)i.push(t.childNodes[a]);for(a=0,o=i.length;o>a;a++)n.insertBefore(i[a],t)}n.removeChild(t)}},_=function(t){return i.isTextarea(t[0])?t.val():t.html()};return{blank:n.bMSIE?"&nbsp;":"<br/>",emptyPara:"<p><br/></p>",isEditable:e,isControlSizing:r,buildLayoutInfo:l,isText:w,isPara:d,isList:c,isTable:s("TABLE"),isCell:u,isAnchor:s("A"),isDiv:s("DIV"),isLi:s("LI"),isSpan:s("SPAN"),isB:s("B"),isU:s("U"),isS:s("S"),isI:s("I"),isImg:s("IMG"),isTextarea:s("TEXTAREA"),ancestor:f,listAncestor:h,listNext:g,listPrev:b,listDescendant:m,commonAncestor:p,listBetween:v,insertAfter:k,position:x,makeOffsetPath:T,fromOffsetPath:S,split:I,remove:M,html:_}}(),r={version:"0.5.1",options:{width:null,height:null,focus:!1,tabsize:null,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,codemirror:null,lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview"]],["help",["help"]]],oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,keyMap:{pc:{"CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule"},mac:{"CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",dragImageHere:"Drag an image here",selectFromFiles:"Select from files",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, or DailyMotion)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Text Size",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"BackColor",foreground:"FontColor",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}},l=function(){var e=function(e){return t.Deferred(function(n){t.extend(new FileReader,{onload:function(t){var e=t.target.result;n.resolve(e)},onerror:function(){n.reject(this)}}).readAsDataURL(e)}).promise()},n=function(e){return t.Deferred(function(n){t("<img>").one("load",function(){n.resolve(t(this))}).one("error abort",function(){n.reject(t(this))}).css({display:"none"}).appendTo(document.body).attr("src",e)}).promise()};return{readFileAsDataURL:e,createImage:n}}(),s={isEdit:function(t){return-1!==[8,9,13,32].indexOf(t)},nameFromCode:{8:"BACKSPACE",9:"TAB",13:"ENTER",32:"SPACE",48:"NUM0",49:"NUM1",50:"NUM2",51:"NUM3",52:"NUM4",53:"NUM5",54:"NUM6",55:"NUM7",56:"NUM8",66:"B",69:"E",73:"I",74:"J",75:"K",76:"L",82:"R",83:"S",85:"U",89:"Y",90:"Z",191:"SLASH",219:"LEFTBRACKET",220:"BACKSLASH",221:"RIGHTBRACKET"}},d=function(){var e=function(e,a){if(n.jqueryVersion<1.9){var o={};return t.each(a,function(t,n){o[n]=e.css(n)}),o}return e.css.call(e,a)};this.stylePara=function(e,n){t.each(e.nodes(i.isPara),function(e,a){t(a).css(n)})},this.current=function(n,a){var o=t(i.isText(n.sc)?n.sc.parentNode:n.sc),r=["font-family","font-size","text-align","list-style-type","line-height"],l=e(o,r)||{};if(l["font-size"]=parseInt(l["font-size"]),l["font-bold"]=document.queryCommandState("bold")?"bold":"normal",l["font-italic"]=document.queryCommandState("italic")?"italic":"normal",l["font-underline"]=document.queryCommandState("underline")?"underline":"normal",n.isOnList()){var s=["circle","disc","disc-leading-zero","square"],d=t.inArray(l["list-style-type"],s)>-1;l["list-style"]=d?"unordered":"ordered"}else l["list-style"]="none";var c=i.ancestor(n.sc,i.isPara);if(c&&c.style["line-height"])l["line-height"]=c.style.lineHeight;else{var u=parseInt(l["line-height"])/parseInt(l["font-size"]);l["line-height"]=u.toFixed(1)}return l.image=i.isImg(a)&&a,l.anchor=n.isOnAnchor()&&i.ancestor(n.sc,i.isAnchor),l.aAncestor=i.listAncestor(n.sc,i.isEditable),l}},c=function(){var e=!!document.createRange,n=function(t,e){var n,a,r=t.parentElement(),l=document.body.createTextRange(),s=o.from(r.childNodes);for(n=0;n<s.length;n++)if(!i.isText(s[n])){if(l.moveToElementText(s[n]),l.compareEndPoints("StartToStart",t)>=0)break;a=s[n]}if(0!==n&&i.isText(s[n-1])){var d=document.body.createTextRange(),c=null;d.moveToElementText(a||r),d.collapse(!a),c=a?a.nextSibling:r.firstChild;var u=t.duplicate();u.setEndPoint("StartToStart",d);for(var f=u.text.replace(/[\r\n]/g,"").length;f>c.nodeValue.length&&c.nextSibling;)f-=c.nodeValue.length,c=c.nextSibling;{c.nodeValue}e&&c.nextSibling&&i.isText(c.nextSibling)&&f===c.nodeValue.length&&(f-=c.nodeValue.length,c=c.nextSibling),r=c,n=f}return{cont:r,offset:n}},r=function(t){var e=function(t,n){var r,l;if(i.isText(t)){var s=i.listPrev(t,a.not(i.isText)),d=o.last(s).previousSibling;r=d||t.parentNode,n+=o.sum(o.tail(s),i.length),l=!d}else{if(r=t.childNodes[n]||t,i.isText(r))return e(r,n);n=0,l=!1}return{cont:r,collapseToStart:l,offset:n}},n=document.body.createTextRange(),r=e(t.cont,t.offset);return n.moveToElementText(r.cont),n.collapse(r.collapseToStart),n.moveStart("character",r.offset),n},l=function(n,l,s,d){this.sc=n,this.so=l,this.ec=s,this.eo=d;var c=function(){if(e){var t=document.createRange();return t.setStart(n,l),t.setEnd(s,d),t}var a=r({cont:n,offset:l});return a.setEndPoint("EndToEnd",r({cont:s,offset:d})),a};this.select=function(){var t=c();if(e){var n=document.getSelection();n.rangeCount>0&&n.removeAllRanges(),n.addRange(t)}else t.select()},this.nodes=function(e){var r=i.listBetween(n,s),l=o.compact(t.map(r,function(t){return i.ancestor(t,e)}));return t.map(o.clusterBy(l,a.eq2),o.head)},this.commonAncestor=function(){return i.commonAncestor(n,s)};var u=function(t){return function(){var e=i.ancestor(n,t);return!!e&&e===i.ancestor(s,t)}};this.isOnEditable=u(i.isEditable),this.isOnList=u(i.isList),this.isOnAnchor=u(i.isAnchor),this.isOnCell=u(i.isCell),this.isCollapsed=function(){return n===s&&l===d},this.insertNode=function(t){var n=c();e?n.insertNode(t):n.pasteHTML(t.outerHTML)},this.toString=function(){var t=c();return e?t.toString():t.text},this.bookmark=function(t){return{s:{path:i.makeOffsetPath(t,n),offset:l},e:{path:i.makeOffsetPath(t,s),offset:d}}}};return{create:function(t,a,o,i){if(0===arguments.length)if(e){var r=document.getSelection();if(0===r.rangeCount)return null;var s=r.getRangeAt(0);t=s.startContainer,a=s.startOffset,o=s.endContainer,i=s.endOffset}else{var d=document.selection.createRange(),c=d.duplicate();c.collapse(!1);var u=d;u.collapse(!0);var f=n(u,!0),h=n(c,!1);t=f.cont,a=f.offset,o=h.cont,i=h.offset}else 2===arguments.length&&(o=t,i=a);return new l(t,a,o,i)},createFromNode:function(t){return this.create(t,0,t,1)},createFromBookmark:function(t,e){var n=i.fromOffsetPath(t,e.s.path),a=e.s.offset,o=i.fromOffsetPath(t,e.e.path),r=e.e.offset;return new l(n,a,o,r)}}}(),u=function(){this.tab=function(t,e){var n=i.ancestor(t.commonAncestor(),i.isCell),a=i.ancestor(n,i.isTable),r=i.listDescendant(a,i.isCell),l=o[e?"prev":"next"](r,n);l&&c.create(l,0).select()},this.createTable=function(e,n){for(var a,o=[],r=0;e>r;r++)o.push("<td>"+i.blank+"</td>");a=o.join("");for(var l,s=[],d=0;n>d;d++)s.push("<tr>"+a+"</tr>");l=s.join("");var c='<table class="table table-bordered">'+l+"</table>";return t(c)[0]}},f=function(){var e=new d,a=new u;this.saveRange=function(t){t.data("range",c.create())},this.restoreRange=function(t){var e=t.data("range");e&&e.select()},this.currentStyle=function(t){var n=c.create();return n.isOnEditable()&&e.current(n,t)},this.undo=function(t){t.data("NoteHistory").undo(t)},this.redo=function(t){t.data("NoteHistory").redo(t)};for(var o=this.recordUndo=function(t){t.data("NoteHistory").recordUndo(t)},r=["bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"],s=0,f=r.length;f>s;s++)this[r[s]]=function(t){return function(e,n){o(e),document.execCommand(t,!1,n)}}(r[s]);var h=function(e,n,a){o(e);var r=new Array(a+1).join("&nbsp;");n.insertNode(t('<span id="noteTab">'+r+"</span>")[0]);var l=t("#noteTab").removeAttr("id");n=c.create(l[0],1),n.select(),i.remove(l[0])};this.tab=function(t,e){var n=c.create();n.isCollapsed()&&n.isOnCell()?a.tab(n):h(t,n,e.tabsize)},this.untab=function(){var t=c.create();t.isCollapsed()&&t.isOnCell()&&a.tab(t,!0)},this.insertImage=function(t,e){l.createImage(e).then(function(e){o(t),e.css({display:"",width:Math.min(t.width(),e.width())}),c.create().insertNode(e[0])}).fail(function(){var e=t.data("callbacks");e.onImageUploadError&&e.onImageUploadError()})},this.insertVideo=function(e,n){o(e);var a,i=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,r=n.match(i),l=/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/,s=n.match(l),d=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/,u=n.match(d),f=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/,h=n.match(f),p=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,v=n.match(p);if(r&&11===r[2].length){var b=r[2];a=t("<iframe>").attr("src","//www.youtube.com/embed/"+b).attr("width","640").attr("height","360")}else s&&s[0].length>0?a=t("<iframe>").attr("src",s[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true"):u&&u[0].length>0?a=t("<iframe>").attr("src",u[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed"):h&&h[3].length>0?a=t("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+h[3]).attr("width","640").attr("height","360"):v&&v[2].length>0&&(a=t("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+v[2]).attr("width","640").attr("height","360"));a&&(a.attr("frameborder",0),c.create().insertNode(a[0]))},this.formatBlock=function(t,e){o(t),e=n.bMSIE?"<"+e+">":e,document.execCommand("FormatBlock",!1,e)},this.formatPara=function(t){this.formatBlock(t,"P")};for(var s=1;6>=s;s++)this["formatH"+s]=function(t){return function(e){this.formatBlock(e,"H"+t)}}(s);this.fontSize=function(t,e){o(t),document.execCommand("fontSize",!1,3),n.bFF?t.find("font[size=3]").removeAttr("size").css("font-size",e+"px"):t.find("span").filter(function(){return"medium"===this.style.fontSize}).css("font-size",e+"px")},this.lineHeight=function(t,n){o(t),e.stylePara(c.create(),{lineHeight:n})},this.unlink=function(t){var e=c.create();if(e.isOnAnchor()){o(t);var n=i.ancestor(e.sc,i.isAnchor);e=c.createFromNode(n),e.select(),document.execCommand("unlink")}},this.createLink=function(e,a,r){var l=c.create();o(e);var s=a;if(-1!==a.indexOf("@")&&-1===a.indexOf(":")?s="mailto:"+a:-1===a.indexOf("://")&&(s="http://"+a),(n.bMSIE||n.bFF)&&l.isCollapsed()){l.insertNode(t('<A id="linkAnchor">'+a+"</A>")[0]);var d=t("#linkAnchor").attr("href",s).removeAttr("id");l=c.createFromNode(d[0]),l.select()}else document.execCommand("createlink",!1,s),l=c.create();t.each(l.nodes(i.isAnchor),function(e,n){r?t(n).attr("target","_blank"):t(n).removeAttr("target")})},this.getLinkInfo=function(){var e=c.create(),n=!0,a="";if(e.isOnAnchor()){var o=i.ancestor(e.sc,i.isAnchor);e=c.createFromNode(o),n="_blank"===t(o).attr("target"),a=o.href}return{text:e.toString(),url:a,newWindow:n}},this.getVideoInfo=function(){var t=c.create();if(t.isOnAnchor()){var e=i.ancestor(t.sc,i.isAnchor);t=c.createFromNode(e)}return{text:t.toString()}},this.color=function(t,e){var n=JSON.parse(e),a=n.foreColor,i=n.backColor;o(t),a&&document.execCommand("foreColor",!1,a),i&&document.execCommand("backColor",!1,i)},this.insertTable=function(t,e){o(t);var n=e.split("x");c.create().insertNode(a.createTable(n[0],n[1]))},this.floatMe=function(t,e,n){o(t),n.css("float",e)},this.resize=function(t,e,n){o(t),n.css({width:t.width()*e+"px",height:""})},this.resizeTo=function(t,e,n){var a;if(n){var o=t.y/t.x,i=e.data("ratio");a={width:i>o?t.x:t.y/i,height:i>o?t.x*i:t.y}}else a={width:t.x,height:t.y};e.css(a)},this.removeMedia=function(t,e,n){o(t),n.detach()}},h=function(){var t=[],e=[],n=function(t){var e=t[0],n=c.create();return{contents:t.html(),bookmark:n.bookmark(e),scrollTop:t.scrollTop()}},a=function(t,e){t.html(e.contents).scrollTop(e.scrollTop),c.createFromBookmark(t[0],e.bookmark).select()};this.undo=function(o){var i=n(o);0!==t.length&&(a(o,t.pop()),e.push(i))},this.redo=function(o){var i=n(o);0!==e.length&&(a(o,e.pop()),t.push(i))},this.recordUndo=function(a){e=[],t.push(n(a))}},p=function(){this.update=function(e,n){var a=function(e,n){e.find(".dropdown-menu li a").each(function(){var e=t(this).data("value")+""==n+"";this.className=e?"checked":""})},i=function(t,n){var a=e.find(t);a.toggleClass("active",n())},r=e.find(".note-fontname");if(r.length>0){var l=n["font-family"];l&&(l=o.head(l.split(",")),l=l.replace(/\'/g,""),r.find(".note-current-fontname").text(l),a(r,l))}var s=e.find(".note-fontsize");s.find(".note-current-fontsize").text(n["font-size"]),a(s,parseFloat(n["font-size"]));var d=e.find(".note-height");a(d,parseFloat(n["line-height"])),i('button[data-event="bold"]',function(){return"bold"===n["font-bold"]}),i('button[data-event="italic"]',function(){return"italic"===n["font-italic"]}),i('button[data-event="underline"]',function(){return"underline"===n["font-underline"]}),i('button[data-event="justifyLeft"]',function(){return"left"===n["text-align"]||"start"===n["text-align"]}),i('button[data-event="justifyCenter"]',function(){return"center"===n["text-align"]}),i('button[data-event="justifyRight"]',function(){return"right"===n["text-align"]}),i('button[data-event="justifyFull"]',function(){return"justify"===n["text-align"]}),i('button[data-event="insertUnorderedList"]',function(){return"unordered"===n["list-style"]}),i('button[data-event="insertOrderedList"]',function(){return"ordered"===n["list-style"]})},this.updateRecentColor=function(e,n,a){var o=t(e).closest(".note-color"),i=o.find(".note-recent-color"),r=JSON.parse(i.attr("data-value"));r[n]=a,i.attr("data-value",JSON.stringify(r));var l="backColor"===n?"background-color":"color";i.find("i").css(l,a)},this.updateFullscreen=function(t,e){var n=t.find('button[data-event="fullscreen"]');n.toggleClass("active",e)},this.updateCodeview=function(t,e){var n=t.find('button[data-event="codeview"]');n.toggleClass("active",e)},this.activate=function(t){t.find("button").not('button[data-event="codeview"]').removeClass("disabled")},this.deactivate=function(t){t.find("button").not('button[data-event="codeview"]').addClass("disabled")}},v=function(){var e=function(e,n){var a=t(n),o=a.position(),i=a.height();e.css({display:"block",left:o.left,top:o.top+i})};this.update=function(t,n){var a=t.find(".note-link-popover");if(n.anchor){var o=a.find("a");o.attr("href",n.anchor.href).html(n.anchor.href),e(a,n.anchor)}else a.hide();var i=t.find(".note-image-popover");n.image?e(i,n.image):i.hide()},this.hide=function(t){t.children().hide()}},b=function(){this.update=function(e,n){var a=e.find(".note-control-selection");if(n.image){var o=t(n.image),i=o.position(),r={w:o.width(),h:o.height()};a.css({display:"block",left:i.left,top:i.top,width:r.w,height:r.h}).data("target",n.image);var l=r.w+"x"+r.h;a.find(".note-control-selection-info").text(l)}else a.hide()},this.hide=function(t){t.children().hide()}},g=function(){var e=function(t,e){t.toggleClass("disabled",!e),t.attr("disabled",!e)};this.showImageDialog=function(n,a){return t.Deferred(function(t){var o=a.find(".note-image-dialog"),i=a.find(".note-image-input"),r=a.find(".note-image-url"),l=a.find(".note-image-btn");o.one("shown.bs.modal",function(n){n.stopPropagation(),i.replaceWith(i.clone().on("change",function(){o.modal("hide"),t.resolve(this.files)})),l.click(function(e){e.preventDefault(),o.modal("hide"),t.resolve(r.val())}),r.keyup(function(){e(l,r.val())}).val("").focus()}).one("hidden.bs.modal",function(t){t.stopPropagation(),n.focus(),i.off("change"),r.off("keyup"),l.off("click")}).modal("show")})},this.showVideoDialog=function(n,a,o){return t.Deferred(function(t){var i=a.find(".note-video-dialog"),r=i.find(".note-video-url"),l=i.find(".note-video-btn");i.one("shown.bs.modal",function(n){n.stopPropagation(),r.val(o.text).keyup(function(){e(l,r.val())}).trigger("keyup").trigger("focus"),l.click(function(e){e.preventDefault(),i.modal("hide"),t.resolve(r.val())})}).one("hidden.bs.modal",function(t){t.stopPropagation(),n.focus(),r.off("keyup"),l.off("click")}).modal("show")})},this.showLinkDialog=function(n,a,o){return t.Deferred(function(t){var i=a.find(".note-link-dialog"),r=i.find(".note-link-text"),l=i.find(".note-link-url"),s=i.find(".note-link-btn"),d=i.find("input[type=checkbox]");i.one("shown.bs.modal",function(n){n.stopPropagation(),r.val(o.text),l.keyup(function(){e(s,l.val()),o.text||r.val(l.val())}).val(o.url).trigger("focus"),d.prop("checked",o.newWindow),s.one("click",function(e){e.preventDefault(),i.modal("hide"),t.resolve(l.val(),d.is(":checked"))})}).one("hidden.bs.modal",function(t){t.stopPropagation(),n.focus(),l.off("keyup")}).modal("show")}).promise()},this.showHelpDialog=function(t,e){var n=e.find(".note-help-dialog");n.one("hidden.bs.modal",function(e){e.stopPropagation(),t.focus()}).modal("show")}},m=function(){var a=new f,o=new p,r=new v,d=new b,c=new g,u=function(e){var n=t(e).closest(".note-editor");return n.length>0&&i.buildLayoutInfo(n)},m=function(e,n){a.restoreRange(e);var o=e.data("callbacks");o.onImageUpload?o.onImageUpload(n,a,e):t.each(n,function(t,n){l.readFileAsDataURL(n).then(function(t){a.insertImage(e,t)}).fail(function(){o.onImageUploadError&&o.onImageUploadError()})})},k=function(t){i.isImg(t.target)&&t.preventDefault()},y=function(t){var e=u(t.currentTarget||t.target),n=a.currentStyle(t.target);n&&(o.update(e.toolbar(),n),r.update(e.popover(),n),d.update(e.handle(),n))},w=function(t){var e=u(t.currentTarget||t.target);r.hide(e.popover()),d.hide(e.handle())},C=function(e){if(i.isControlSizing(e.target)){var n=u(e.target),o=n.handle(),l=n.popover(),s=n.editable(),c=n.editor(),f=o.find(".note-control-selection").data("target"),h=t(f),p=h.offset(),v=t(document).scrollTop();c.on("mousemove",function(t){a.resizeTo({x:t.clientX-p.left,y:t.clientY-(p.top-v)},h,!t.shiftKey),d.update(o,{image:f}),r.update(l,{image:f})}).one("mouseup",function(){c.off("mousemove")}),h.data("ratio")||h.data("ratio",h.height()/h.width()),a.recordUndo(s),e.stopPropagation(),e.preventDefault()}},x=function(e){var n=t(e.target).closest("[data-event]");n.length>0&&e.preventDefault()},T=function(r){var l=t(r.target).closest("[data-event]");if(l.length>0){var s,d,f,h=l.attr("data-event"),p=l.attr("data-value"),v=u(r.target),b=v.editor(),g=v.toolbar(),k=v.dialog(),w=v.editable(),C=v.codable(),x=b.data("options");if(-1!==t.inArray(h,["resize","floatMe","removeMedia"])){var T=v.handle(),S=T.find(".note-control-selection");f=t(S.data("target"))}if(a[h]&&(w.trigger("focus"),a[h](w,p,f)),-1!==t.inArray(h,["backColor","foreColor"]))o.updateRecentColor(l[0],h,p);else if("showLinkDialog"===h){w.focus();var F=a.getLinkInfo();a.saveRange(w),c.showLinkDialog(w,k,F).then(function(t,e){a.restoreRange(w),a.createLink(w,t,e)})}else if("showImageDialog"===h)w.focus(),c.showImageDialog(w,k).then(function(t){"string"==typeof t?(a.restoreRange(w),a.insertImage(w,t)):m(w,t)});else if("showVideoDialog"===h){w.focus();var I=a.getVideoInfo();a.saveRange(w),c.showVideoDialog(w,k,I).then(function(t){a.restoreRange(w),a.insertVideo(w,t)})}else if("showHelpDialog"===h)c.showHelpDialog(w,k);else if("fullscreen"===h){var M=t("html, body"),_=function(t){b.css("width",t.w),w.css("height",t.h),C.css("height",t.h),C.data("cmEditor")&&C.data("cmEditor").setSize(null,t.h)};b.toggleClass("fullscreen");var E=b.hasClass("fullscreen");E?(w.data("orgHeight",w.css("height")),t(window).on("resize",function(){_({w:t(window).width(),h:t(window).height()-g.outerHeight()})}).trigger("resize"),M.css("overflow","hidden")):(t(window).off("resize"),_({w:x.width||"",h:w.data("orgHeight")}),M.css("overflow","auto")),o.updateFullscreen(g,E)}else if("codeview"===h){b.toggleClass("codeview");var N=b.hasClass("codeview");if(N){if(C.val(w.html()),C.height(w.height()),o.deactivate(g),C.focus(),n.bCodeMirror){d=e.fromTextArea(C[0],t.extend({mode:"text/html",lineNumbers:!0},x.codemirror));var A=b.data("options").codemirror.tern||!1;A&&(s=new e.TernServer(A),d.ternServer=s,d.on("cursorActivity",function(t){s.updateArgHints(t)})),d.setSize(null,w.outerHeight()),d.autoFormatRange&&d.autoFormatRange({line:0,ch:0},{line:d.lineCount(),ch:d.getTextArea().value.length}),C.data("cmEditor",d)}}else n.bCodeMirror&&(d=C.data("cmEditor"),C.val(d.getValue()),d.toTextArea()),w.html(C.val()||i.emptyPara),w.height(x.height?C.height():"auto"),o.activate(g),w.focus();o.updateCodeview(v.toolbar(),N)}y(r)}},S=24,F=function(e){var n=t(document),a=u(e.target).editable(),o=a.offset().top-n.scrollTop();n.on("mousemove",function(t){var e=t.clientY-(o+S);a.height(e)}).one("mouseup",function(){n.off("mousemove")}),e.stopPropagation(),e.preventDefault()},I=18,M=function(e){var n,a=t(e.target.parentNode),o=a.next(),i=a.find(".note-dimension-picker-mousecatcher"),r=a.find(".note-dimension-picker-highlighted"),l=a.find(".note-dimension-picker-unhighlighted");if(void 0===e.offsetX){var s=t(e.target).offset();n={x:e.pageX-s.left,y:e.pageY-s.top}}else n={x:e.offsetX,y:e.offsetY};var d={c:Math.ceil(n.x/I)||1,r:Math.ceil(n.y/I)||1};r.css({width:d.c+"em",height:d.r+"em"}),i.attr("data-value",d.c+"x"+d.r),3<d.c&&d.c<10&&l.css({width:d.c+1+"em"}),3<d.r&&d.r<10&&l.css({height:d.r+1+"em"}),o.html(d.c+" x "+d.r)},_=function(e){var n=t(),a=e.dropzone,o=e.dropzone.find(".note-dropzone-message");t(document).on("dragenter",function(t){var i=e.editor.hasClass("codeview");i||0!==n.length||(e.editor.addClass("dragover"),a.width(e.editor.width()),a.height(e.editor.height()),o.text("Drag Image Here")),n=n.add(t.target)}).on("dragleave",function(t){n=n.not(t.target),0===n.length&&e.editor.removeClass("dragover")}).on("drop",function(){n=t(),e.editor.removeClass("dragover")}),a.on("dragenter",function(){a.addClass("hover"),o.text("Drop Image")}).on("dragleave",function(){a.removeClass("hover"),o.text("Drag Image Here")}),a.on("drop",function(t){var e=t.originalEvent.dataTransfer;if(e&&e.files){var n=u(t.currentTarget||t.target);n.editable().focus(),m(n.editable(),e.files)}t.preventDefault()}).on("dragover",!1)};this.bindKeyMap=function(t,e){var n=t.editor,o=t.editable;o.on("keydown",function(t){var i=[];t.metaKey&&i.push("CMD"),t.ctrlKey&&i.push("CTRL"),t.shiftKey&&i.push("SHIFT");var r=s.nameFromCode[t.keyCode];r&&i.push(r);var l=e[i.join("+")];l?(t.preventDefault(),a[l](o,n.data("options"))):s.isEdit(t.keyCode)&&a.recordUndo(o)})},this.attach=function(t,e){var o=e.keyMap[n.bMac?"mac":"pc"];this.bindKeyMap(t,o),t.editable.on("mousedown",k),t.editable.on("keyup mouseup",y),t.editable.on("scroll",w),e.disableDragAndDrop||_(t),t.handle.on("mousedown",C),t.toolbar.on("click",T),t.popover.on("click",T),t.toolbar.on("mousedown",x),t.popover.on("mousedown",x),t.statusbar.on("mousedown",F);var i=t.toolbar,r=i.find(".note-dimension-picker-mousecatcher");r.on("mousemove",M),t.editable.on("blur",function(){a.saveRange(t.editable)}),t.editor.data("options",e),e.styleWithSpan&&!n.bMSIE&&setTimeout(function(){document.execCommand("styleWithCSS",0,!0)}),t.editable.data("NoteHistory",new h),e.onenter&&t.editable.keypress(function(t){t.keyCode===s.ENTER&&e.onenter(t)}),e.onfocus&&t.editable.focus(e.onfocus),e.onblur&&t.editable.blur(e.onblur),e.onkeyup&&(t.editable.keyup(e.onkeyup),t.toolbar.click(e.onkeyup)),e.onkeydown&&t.editable.keydown(e.onkeydown),e.onpaste&&t.editable.on("paste",e.onpaste),e.onToolbarClick&&t.toolbar.click(e.onToolbarClick),t.editable.data("callbacks",{onChange:e.onChange,onAutoSave:e.onAutoSave,onImageUpload:e.onImageUpload,onImageUploadError:e.onImageUploadError,onFileUpload:e.onFileUpload,onFileUploadError:e.onFileUpload})},this.dettach=function(t){t.editable.off(),t.toolbar.off(),t.handle.off(),t.popover.off()}},k=function(){var e,a,o,r,l;e={picture:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.image.image+'" data-event="showImageDialog" tabindex="-1"><i class="fa fa-picture-o icon-picture"></i></button>'},link:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.link.link+'" data-event="showLinkDialog" tabindex="-1"><i class="fa fa-link icon-link"></i></button>'},video:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.video.video+'" data-event="showVideoDialog" tabindex="-1"><i class="fa fa-youtube-play icon-play"></i></button>'},table:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+t.table.table+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-table icon-table"></i> <span class="caret"></span></button><ul class="dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>'},style:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+t.style.style+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-text-height"></i> <span class="caret"></span></button><ul class="dropdown-menu"><li><a data-event="formatBlock" data-value="h1"><h1>'+t.style.h1+'</h1></a></li><li><a data-event="formatBlock" data-value="h2"><h2>'+t.style.h2+'</h2></a></li><li><a data-event="formatBlock" data-value="h3"><h3>'+t.style.h3+'</h3></a></li><li><a data-event="formatBlock" data-value="h4"><h4>'+t.style.h4+'</h4></a></li><li><a data-event="formatBlock" data-value="p">'+t.style.normal+"</a></li></ul>"},fontname:function(t){var e=["Serif","Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Lucida Sans","Tahoma","Times","Times New Roman","Verdana"],n='<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+t.font.name+'" tabindex="-1"><span class="note-current-fontname">Arial</span> <b class="caret"></b></button>';n+='<ul class="dropdown-menu">';for(var a=0;a<e.length;a++)n+='<li><a data-event="fontName" data-value="'+e[a]+'"><i class="fa fa-check icon-ok"></i> '+e[a]+"</a></li>";
return n+="</ul>"},fontsize:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+t.font.size+'" tabindex="-1"><span class="note-current-fontsize">11</span> <b class="caret"></b></button><ul class="dropdown-menu"><li><a data-event="fontSize" data-value="8"><i class="fa fa-check icon-ok"></i> 8</a></li><li><a data-event="fontSize" data-value="9"><i class="fa fa-check icon-ok"></i> 9</a></li><li><a data-event="fontSize" data-value="10"><i class="fa fa-check icon-ok"></i> 10</a></li><li><a data-event="fontSize" data-value="11"><i class="fa fa-check icon-ok"></i> 11</a></li><li><a data-event="fontSize" data-value="12"><i class="fa fa-check icon-ok"></i> 12</a></li><li><a data-event="fontSize" data-value="14"><i class="fa fa-check icon-ok"></i> 14</a></li><li><a data-event="fontSize" data-value="18"><i class="fa fa-check icon-ok"></i> 18</a></li><li><a data-event="fontSize" data-value="24"><i class="fa fa-check icon-ok"></i> 24</a></li><li><a data-event="fontSize" data-value="36"><i class="fa fa-check icon-ok"></i> 36</a></li></ul>'},color:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small note-recent-color" title="'+t.color.recent+'" data-event="color" data-value=\'{"backColor":"yellow"}\' tabindex="-1"><i class="fa fa-font icon-font" style="color:black;background-color:yellow;"></i></button><button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+t.color.more+'" data-toggle="dropdown" tabindex="-1"><span class="caret"></span></button><ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+t.color.foreground+'</div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+t.color.reset+'">'+t.color.resetToDefault+'</div><div class="note-color-palette" data-target-event="foreColor"></div></div></li></ul>'},bold:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.font.bold+'" data-shortcut="Ctrl+B" data-mac-shortcut="\u2318+B" data-event="bold" tabindex="-1"><i class="fa fa-bold icon-bold"></i></button>'},italic:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.font.italic+'" data-shortcut="Ctrl+I" data-mac-shortcut="\u2318+I" data-event="italic" tabindex="-1"><i class="fa fa-italic icon-italic"></i></button>'},underline:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.font.underline+'" data-shortcut="Ctrl+U" data-mac-shortcut="\u2318+U" data-event="underline" tabindex="-1"><i class="fa fa-underline icon-underline"></i></button>'},clear:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.font.clear+'" data-shortcut="Ctrl+\\" data-mac-shortcut="\u2318+\\" data-event="removeFormat" tabindex="-1"><i class="fa fa-eraser icon-eraser"></i></button>'},ul:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.lists.unordered+'" data-shortcut="Ctrl+Shift+8" data-mac-shortcut="\u2318+\u21e7+7" data-event="insertUnorderedList" tabindex="-1"><i class="fa fa-list-ul icon-list-ul"></i></button>'},ol:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.lists.ordered+'" data-shortcut="Ctrl+Shift+7" data-mac-shortcut="\u2318+\u21e7+8" data-event="insertOrderedList" tabindex="-1"><i class="fa fa-list-ol icon-list-ol"></i></button>'},paragraph:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+t.paragraph.paragraph+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-align-left icon-align-left"></i>  <span class="caret"></span></button><div class="dropdown-menu"><div class="note-align btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.paragraph.left+'" data-shortcut="Ctrl+Shift+L" data-mac-shortcut="\u2318+\u21e7+L" data-event="justifyLeft" tabindex="-1"><i class="fa fa-align-left icon-align-left"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.paragraph.center+'" data-shortcut="Ctrl+Shift+E" data-mac-shortcut="\u2318+\u21e7+E" data-event="justifyCenter" tabindex="-1"><i class="fa fa-align-center icon-align-center"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.paragraph.right+'" data-shortcut="Ctrl+Shift+R" data-mac-shortcut="\u2318+\u21e7+R" data-event="justifyRight" tabindex="-1"><i class="fa fa-align-right icon-align-right"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.paragraph.justify+'" data-shortcut="Ctrl+Shift+J" data-mac-shortcut="\u2318+\u21e7+J" data-event="justifyFull" tabindex="-1"><i class="fa fa-align-justify icon-align-justify"></i></button></div><div class="note-list btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.paragraph.outdent+'" data-shortcut="Ctrl+[" data-mac-shortcut="\u2318+[" data-event="outdent" tabindex="-1"><i class="fa fa-outdent icon-indent-left"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.paragraph.indent+'" data-shortcut="Ctrl+]" data-mac-shortcut="\u2318+]" data-event="indent" tabindex="-1"><i class="fa fa-indent icon-indent-right"></i></button></div></div>'},height:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+t.font.height+'" tabindex="-1"><i class="fa fa-text-height icon-text-height"></i>&nbsp; <b class="caret"></b></button><ul class="dropdown-menu"><li><a data-event="lineHeight" data-value="1.0"><i class="fa fa-check icon-ok"></i> 1.0</a></li><li><a data-event="lineHeight" data-value="1.2"><i class="fa fa-check icon-ok"></i> 1.2</a></li><li><a data-event="lineHeight" data-value="1.4"><i class="fa fa-check icon-ok"></i> 1.4</a></li><li><a data-event="lineHeight" data-value="1.5"><i class="fa fa-check icon-ok"></i> 1.5</a></li><li><a data-event="lineHeight" data-value="1.6"><i class="fa fa-check icon-ok"></i> 1.6</a></li><li><a data-event="lineHeight" data-value="1.8"><i class="fa fa-check icon-ok"></i> 1.8</a></li><li><a data-event="lineHeight" data-value="2.0"><i class="fa fa-check icon-ok"></i> 2.0</a></li><li><a data-event="lineHeight" data-value="3.0"><i class="fa fa-check icon-ok"></i> 3.0</a></li></ul>'},help:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.options.help+'" data-event="showHelpDialog" tabindex="-1"><i class="fa fa-question icon-question"></i></button>'},fullscreen:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.options.fullscreen+'" data-event="fullscreen" tabindex="-1"><i class="fa fa-arrows-alt icon-fullscreen"></i></button>'},codeview:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.options.codeview+'" data-event="codeview" tabindex="-1"><i class="fa fa-code icon-code"></i></button>'},undo:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.history.undo+'" data-event="undo" tabindex="-1"><i class="fa fa-undo icon-undo"></i></button>'},redo:function(t){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+t.history.redo+'" data-event="redo" tabindex="-1"><i class="fa fa-repeat icon-repeat"></i></button>'}},a=function(t){return'<div class="note-popover"><div class="note-link-popover popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content note-link-content"><a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.link.edit+'" data-event="showLinkDialog" tabindex="-1"><i class="fa fa-edit icon-edit"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.link.unlink+'" data-event="unlink" tabindex="-1"><i class="fa fa-unlink icon-unlink"></i></button></div></div></div><div class="note-image-popover popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content note-image-content"><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.image.resizeFull+'" data-event="resize" data-value="1" tabindex="-1"><span class="note-fontsize-10">100%</span> </button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.image.resizeHalf+'" data-event="resize" data-value="0.5" tabindex="-1"><span class="note-fontsize-10">50%</span> </button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.image.resizeQuarter+'" data-event="resize" data-value="0.25" tabindex="-1"><span class="note-fontsize-10">25%</span> </button></div><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.image.floatLeft+'" data-event="floatMe" data-value="left" tabindex="-1"><i class="fa fa-align-left icon-align-left"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.image.floatRight+'" data-event="floatMe" data-value="right" tabindex="-1"><i class="fa fa-align-right icon-align-right"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.image.floatNone+'" data-event="floatMe" data-value="none" tabindex="-1"><i class="fa fa-align-justify icon-align-justify"></i></button></div><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+t.image.remove+'" data-event="removeMedia" data-value="none" tabindex="-1"><i class="fa fa-trash-o icon-trash"></i></button></div></div></div></div>'};var o=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'},s=function(t){return'<table class="note-shortcut"><thead><tr><th></th><th>'+t.shortcut.textFormatting+"</th></tr></thead><tbody><tr><td>\u2318 + B</td><td>"+t.font.bold+"</td></tr><tr><td>\u2318 + I</td><td>"+t.font.italic+"</td></tr><tr><td>\u2318 + U</td><td>"+t.font.underline+"</td></tr><tr><td>\u2318 + \u21e7 + S</td><td>"+t.font.strike+"</td></tr><tr><td>\u2318 + \\</td><td>"+t.font.clear+"</td></tr></tr></tbody></table>"},d=function(t){return'<table class="note-shortcut"><thead><tr><th></th><th>'+t.shortcut.action+"</th></tr></thead><tbody><tr><td>\u2318 + Z</td><td>"+t.history.undo+"</td></tr><tr><td>\u2318 + \u21e7 + Z</td><td>"+t.history.redo+"</td></tr><tr><td>\u2318 + ]</td><td>"+t.paragraph.indent+"</td></tr><tr><td>\u2318 + [</td><td>"+t.paragraph.outdent+"</td></tr><tr><td>\u2318 + ENTER</td><td>"+t.hr.insert+"</td></tr></tbody></table>"},c=function(t,e){var n='<table class="note-shortcut"><thead><tr><th></th><th>'+t.shortcut.extraKeys+"</th></tr></thead><tbody>";for(var a in e.extraKeys)e.extraKeys.hasOwnProperty(a)&&(n+="<tr><td>"+a+"</td><td>"+e.extraKeys[a]+"</td></tr>");return n+="</tbody></table>"},u=function(t){return'<table class="note-shortcut"><thead><tr><th></th><th>'+t.shortcut.paragraphFormatting+"</th></tr></thead><tbody><tr><td>\u2318 + \u21e7 + L</td><td>"+t.paragraph.left+"</td></tr><tr><td>\u2318 + \u21e7 + E</td><td>"+t.paragraph.center+"</td></tr><tr><td>\u2318 + \u21e7 + R</td><td>"+t.paragraph.right+"</td></tr><tr><td>\u2318 + \u21e7 + J</td><td>"+t.paragraph.justify+"</td></tr><tr><td>\u2318 + \u21e7 + NUM7</td><td>"+t.lists.ordered+"</td></tr><tr><td>\u2318 + \u21e7 + NUM8</td><td>"+t.lists.unordered+"</td></tr></tbody></table>"},f=function(t){return'<table class="note-shortcut"><thead><tr><th></th><th>'+t.shortcut.documentStyle+"</th></tr></thead><tbody><tr><td>\u2318 + NUM0</td><td>"+t.style.normal+"</td></tr><tr><td>\u2318 + NUM1</td><td>"+t.style.h1+"</td></tr><tr><td>\u2318 + NUM2</td><td>"+t.style.h2+"</td></tr><tr><td>\u2318 + NUM3</td><td>"+t.style.h3+"</td></tr><tr><td>\u2318 + NUM4</td><td>"+t.style.h4+"</td></tr><tr><td>\u2318 + NUM5</td><td>"+t.style.h5+"</td></tr><tr><td>\u2318 + NUM6</td><td>"+t.style.h6+"</td></tr></tbody></table>"},h=function(t,e){var n='<table class="note-shortcut-layout"><tbody><tr><td>'+d(t,e)+"</td><td>"+s(t,e)+"</td></tr><tr><td>"+f(t,e)+"</td><td>"+u(t,e)+"</td></tr>";return e.extraKeys&&(n+='<tr><td colspan="2">'+c(t,e)+"</td></tr>"),n+="</tbody</table>"},p=function(t){return t.replace(/\u2318/g,"Ctrl").replace(/\u21e7/g,"Shift")};r=function(t,e){var a=function(){return'<div class="note-image-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4>'+t.image.insert+'</h4></div><div class="modal-body"><div class="row-fluid"><h5>'+t.image.selectFromFiles+'</h5><input class="note-image-input" type="file" name="files" accept="image/*" /><h5>'+t.image.url+'</h5><input class="note-image-url form-control span12" type="text" /></div></div><div class="modal-footer"><button href="#" class="btn btn-primary note-image-btn disabled" disabled="disabled">'+t.image.insert+"</button></div></div></div></div>"},o=function(){return'<div class="note-link-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4>'+t.link.insert+'</h4></div><div class="modal-body"><div class="row-fluid"><div class="form-group"><label>'+t.link.textToDisplay+'</label><input class="note-link-text form-control span12" disabled type="text" /></div><div class="form-group"><label>'+t.link.url+'</label><input class="note-link-url form-control span12" type="text" /></div>'+(e.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+t.link.openInNewWindow+"</label></div>")+'</div></div><div class="modal-footer"><button href="#" class="btn btn-primary note-link-btn disabled" disabled="disabled">'+t.link.insert+"</button></div></div></div></div>"},i=function(){return'<div class="note-video-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4>'+t.video.insert+'</h4></div><div class="modal-body"><div class="row-fluid"><div class="form-group"><label>'+t.video.url+'</label>&nbsp;<small class="text-muted">'+t.video.providers+'</small><input class="note-video-url form-control span12" type="text" /></div></div></div><div class="modal-footer"><button href="#" class="btn btn-primary note-video-btn disabled" disabled="disabled">'+t.video.insert+"</button></div></div></div></div>"},r=function(){return'<div class="note-help-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+t.shortcut.close+'</a><div class="title">'+t.shortcut.shortcuts+"</div>"+(n.bMac?h(t,e):p(h(t,e)))+'<p class="text-center"><a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.1</a> \xb7 <a href="//github.com/HackerWins/summernote" target="_blank">Project</a> \xb7 <a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues</a></p></div></div></div></div>'};return'<div class="note-dialog">'+a()+o()+i()+r()+"</div>"},l=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'};var v=function(e,a){e.find("button").each(function(e,a){var o=t(a),i=o.attr(n.bMac?"data-mac-shortcut":"data-shortcut");i&&o.attr("title",function(t,e){return e+" ("+i+")"})}).tooltip({container:"body",trigger:"hover",placement:a||"top"}).on("click",function(){t(this).tooltip("hide")})},b=[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],g=function(e){e.find(".note-color-palette").each(function(){for(var e=t(this),n=e.attr("data-target-event"),a=[],o=0,i=b.length;i>o;o++){for(var r=b[o],l=[],s=0,d=r.length;d>s;s++){var c=r[s];l.push(['<button type="button" class="note-color-btn" style="background-color:',c,';" data-event="',n,'" data-value="',c,'" title="',c,'" data-toggle="button" tabindex="-1"></button>'].join(""))}a.push("<div>"+l.join("")+"</div>")}e.html(a.join(""))})};this.createLayout=function(n,s){var d=n.next();if(!d||!d.hasClass("note-editor")){var c=t('<div class="note-editor"></div>');s.width&&c.width(s.width),s.height>0&&t('<div class="note-statusbar">'+l()+"</div>").prependTo(c);var u=!n.is(":disabled"),f=t('<div class="note-editable" contentEditable="'+u+'"></div>').prependTo(c);s.height&&f.height(s.height),s.direction&&f.attr("dir",s.direction),f.html(i.html(n)||i.emptyPara),t('<textarea class="note-codable"></textarea>').prependTo(c);for(var h=t.summernote.lang[s.lang],p="",b=0,m=s.toolbar.length;m>b;b++){var k=s.toolbar[b];p+='<div class="note-'+k[0]+' btn-group">';for(var y=0,w=k[1].length;w>y;y++)p+=e[k[1][y]](h);p+="</div>"}p='<div class="note-toolbar btn-toolbar">'+p+"</div>";var C=t(p).prependTo(c);g(C),v(C,"bottom");var x=t(a(h)).prependTo(c);v(x),t(o()).prependTo(c);var T=t(r(h,s)).prependTo(c);T.find("button.close, a.modal-close").click(function(){t(this).closest(".modal").modal("hide")}),t('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(c),c.insertAfter(n),n.hide()}},this.layoutInfoFromHolder=function(t){var e=t.next();if(e.hasClass("note-editor")){var n=i.buildLayoutInfo(e);for(var a in n)n.hasOwnProperty(a)&&(n[a]=n[a].call());return n}},this.removeLayout=function(t){var e=this.layoutInfoFromHolder(t);e&&(t.html(e.editable.html()),e.editor.remove(),t.show())}};t.summernote=t.summernote||{},t.extend(t.summernote,r);var y=new k,w=new m;t.fn.extend({summernote:function(e){if(e=t.extend({},t.summernote.options,e),this.each(function(n,a){var o=t(a);y.createLayout(o,e);var r=y.layoutInfoFromHolder(o);w.attach(r,e),i.isTextarea(o[0])&&o.closest("form").submit(function(){o.html(o.code())})}),this.first()&&e.focus){var n=y.layoutInfoFromHolder(this.first());n.editable.focus()}return this.length>0&&e.oninit&&e.oninit(),this},code:function(e){if(void 0===e){var a=this.first();if(0===a.length)return;var o=y.layoutInfoFromHolder(a);if(o&&o.editable){var i=o.editor.hasClass("codeview");return i&&n.bCodeMirror&&o.codable.data("cmEditor").save(),i?o.codable.val():o.editable.html()}return a.html()}return this.each(function(n,a){var o=y.layoutInfoFromHolder(t(a));o&&o.editable&&o.editable.html(e)}),this},destroy:function(){return this.each(function(e,n){var a=t(n),o=y.layoutInfoFromHolder(a);o&&o.editable&&(w.dettach(o),y.removeLayout(a))}),this}})}),function(t){var e=function(){var e='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',n={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:!0,flat:!1,layout:"full",submit:1,submitText:"OK",height:156},r=function(e,n){var a=i(e);t(n).data("colpick").fields.eq(1).val(a.r).end().eq(2).val(a.g).end().eq(3).val(a.b).end()},s=function(e,n){t(n).data("colpick").fields.eq(4).val(Math.round(e.h)).end().eq(5).val(Math.round(e.s)).end().eq(6).val(Math.round(e.b)).end()},d=function(e,n){t(n).data("colpick").fields.eq(0).val(l(e))},c=function(e,n){t(n).data("colpick").selector.css("backgroundColor","#"+l({h:e.h,s:100,b:100})),t(n).data("colpick").selectorIndic.css({left:parseInt(t(n).data("colpick").height*e.s/100,10),top:parseInt(t(n).data("colpick").height*(100-e.b)/100,10)})},u=function(e,n){t(n).data("colpick").hue.css("top",parseInt(t(n).data("colpick").height-t(n).data("colpick").height*e.h/360,10))},f=function(e,n){t(n).data("colpick").currentColor.css("backgroundColor","#"+l(e))},h=function(e,n){t(n).data("colpick").newColor.css("backgroundColor","#"+l(e))},p=function(){var e,n=t(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?(n.data("colpick").color=e=a(A(this.value)),r(e,n.get(0)),s(e,n.get(0))):this.parentNode.className.indexOf("_hsb")>0?(n.data("colpick").color=e=E({h:parseInt(n.data("colpick").fields.eq(4).val(),10),s:parseInt(n.data("colpick").fields.eq(5).val(),10),b:parseInt(n.data("colpick").fields.eq(6).val(),10)}),r(e,n.get(0)),d(e,n.get(0))):(n.data("colpick").color=e=o(N({r:parseInt(n.data("colpick").fields.eq(1).val(),10),g:parseInt(n.data("colpick").fields.eq(2).val(),10),b:parseInt(n.data("colpick").fields.eq(3).val(),10)})),d(e,n.get(0)),s(e,n.get(0))),c(e,n.get(0)),u(e,n.get(0)),h(e,n.get(0)),n.data("colpick").onChange.apply(n.parent(),[e,l(e),i(e),n.data("colpick").el,0])},v=function(){t(this).parent().removeClass("colpick_focus")},b=function(){t(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),t(this).parent().addClass("colpick_focus")},g=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var n=t(this).parent().find("input").focus(),a={el:t(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:e.pageY,field:n,val:parseInt(n.val(),10),preview:t(this).parent().parent().data("colpick").livePreview};t(document).mouseup(a,k),t(document).mousemove(a,m)},m=function(t){return t.data.field.val(Math.max(0,Math.min(t.data.max,parseInt(t.data.val-t.pageY+t.data.y,10)))),t.data.preview&&p.apply(t.data.field.get(0),[!0]),!1},k=function(e){return p.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colpick_slider").find("input").focus(),t(document).off("mouseup",k),t(document).off("mousemove",m),!1},y=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var n={cal:t(this).parent(),y:t(this).offset().top};t(document).on("mouseup touchend",n,C),t(document).on("mousemove touchmove",n,w);var a="touchstart"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;return p.apply(n.cal.data("colpick").fields.eq(4).val(parseInt(360*(n.cal.data("colpick").height-(a-n.y))/n.cal.data("colpick").height,10)).get(0),[n.cal.data("colpick").livePreview]),!1},w=function(t){var e="touchmove"==t.type?t.originalEvent.changedTouches[0].pageY:t.pageY;return p.apply(t.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.y)))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},C=function(e){return r(e.data.cal.data("colpick").color,e.data.cal.get(0)),d(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",C),t(document).off("mousemove touchmove",w),!1},x=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var n={cal:t(this).parent(),pos:t(this).offset()};n.preview=n.cal.data("colpick").livePreview,t(document).on("mouseup touchend",n,S),t(document).on("mousemove touchmove",n,T);var a;return"touchstart"==e.type?(pageX=e.originalEvent.changedTouches[0].pageX,a=e.originalEvent.changedTouches[0].pageY):(pageX=e.pageX,a=e.pageY),p.apply(n.cal.data("colpick").fields.eq(6).val(parseInt(100*(n.cal.data("colpick").height-(a-n.pos.top))/n.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-n.pos.left)/n.cal.data("colpick").height,10)).get(0),[n.preview]),!1},T=function(t){var e;return"touchmove"==t.type?(pageX=t.originalEvent.changedTouches[0].pageX,e=t.originalEvent.changedTouches[0].pageY):(pageX=t.pageX,e=t.pageY),p.apply(t.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.pos.top)))/t.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(t.data.cal.data("colpick").height,pageX-t.data.pos.left))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},S=function(e){return r(e.data.cal.data("colpick").color,e.data.cal.get(0)),d(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",S),t(document).off("mousemove touchmove",T),!1},F=function(){var e=t(this).parent(),n=e.data("colpick").color;e.data("colpick").origColor=n,f(n,e.get(0)),e.data("colpick").onSubmit(n,l(n),i(n),e.data("colpick").el)},I=function(e){e.stopPropagation();var n=t("#"+t(this).data("colpickId"));n.data("colpick").onBeforeShow.apply(this,[n.get(0)]);var a=t(this).offset(),o=a.top+this.offsetHeight,i=a.left,r=_(),l=n.width();i+l>r.l+r.w&&(i-=l),n.css({left:i+"px",top:o+"px"}),0!=n.data("colpick").onShow.apply(this,[n.get(0)])&&n.show(),t("html").mousedown({cal:n},M),n.mousedown(function(t){t.stopPropagation()})},M=function(e){0!=e.data.cal.data("colpick").onHide.apply(this,[e.data.cal.get(0)])&&e.data.cal.hide(),t("html").off("mousedown",M)},_=function(){var t="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(t?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(t?document.documentElement.clientWidth:document.body.clientWidth)}},E=function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),b:Math.min(100,Math.max(0,t.b))}},N=function(t){return{r:Math.min(255,Math.max(0,t.r)),g:Math.min(255,Math.max(0,t.g)),b:Math.min(255,Math.max(0,t.b))}},A=function(t){var e=6-t.length;if(e>0){for(var n=[],a=0;e>a;a++)n.push("0");n.push(t),t=n.join("")}return t},L=function(){var e=t(this).parent(),n=e.data("colpick").origColor;e.data("colpick").color=n,r(n,e.get(0)),d(n,e.get(0)),s(n,e.get(0)),c(n,e.get(0)),u(n,e.get(0)),h(n,e.get(0))};return{init:function(i){if(i=t.extend({},n,i||{}),"string"==typeof i.color)i.color=a(i.color);else if(void 0!=i.color.r&&void 0!=i.color.g&&void 0!=i.color.b)i.color=o(i.color);else{if(void 0==i.color.h||void 0==i.color.s||void 0==i.color.b)return this;i.color=E(i.color)}return this.each(function(){if(!t(this).data("colpickId")){var n=t.extend({},i);n.origColor=i.color;var a="collorpicker_"+parseInt(1e3*Math.random());t(this).data("colpickId",a);var o=t(e).attr("id",a);o.addClass("colpick_"+n.layout+(n.submit?"":" colpick_"+n.layout+"_ns")),"light"!=n.colorScheme&&o.addClass("colpick_"+n.colorScheme),o.find("div.colpick_submit").html(n.submitText).click(F),n.fields=o.find("input").change(p).blur(v).focus(b),o.find("div.colpick_field_arrs").mousedown(g).end().find("div.colpick_current_color").click(L),n.selector=o.find("div.colpick_color").on("mousedown touchstart",x),n.selectorIndic=n.selector.find("div.colpick_selector_outer"),n.el=this,n.hue=o.find("div.colpick_hue_arrs"),huebar=n.hue.parent();var l=navigator.userAgent.toLowerCase(),m="Microsoft Internet Explorer"===navigator.appName,k=m?parseFloat(l.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,w=m&&10>k,C=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(w){var T,S;for(T=0;11>=T;T++)S=t("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+C[T]+", endColorstr="+C[T+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+C[T]+", endColorstr="+C[T+1]+')";'),huebar.append(S)}else stopList=C.join(","),huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ");o.find("div.colpick_hue").on("mousedown touchstart",y),n.newColor=o.find("div.colpick_new_color"),n.currentColor=o.find("div.colpick_current_color"),o.data("colpick",n),r(n.color,o.get(0)),s(n.color,o.get(0)),d(n.color,o.get(0)),u(n.color,o.get(0)),c(n.color,o.get(0)),f(n.color,o.get(0)),h(n.color,o.get(0)),n.flat?(o.appendTo(this).show(),o.css({position:"relative",display:"block"})):(o.appendTo(document.body),t(this).on(n.showEvent,I),o.css({position:"absolute"}))}})},showPicker:function(){return this.each(function(){t(this).data("colpickId")&&I.apply(this)})},hidePicker:function(){return this.each(function(){t(this).data("colpickId")&&t("#"+t(this).data("colpickId")).hide()})},setColor:function(e,n){if(n="undefined"==typeof n?1:n,"string"==typeof e)e=a(e);else if(void 0!=e.r&&void 0!=e.g&&void 0!=e.b)e=o(e);else{if(void 0==e.h||void 0==e.s||void 0==e.b)return this;e=E(e)}return this.each(function(){if(t(this).data("colpickId")){var a=t("#"+t(this).data("colpickId"));a.data("colpick").color=e,a.data("colpick").origColor=e,r(e,a.get(0)),s(e,a.get(0)),d(e,a.get(0)),u(e,a.get(0)),c(e,a.get(0)),h(e,a.get(0)),a.data("colpick").onChange.apply(a.parent(),[e,l(e),i(e),a.data("colpick").el,1]),n&&f(e,a.get(0))}})}}}(),n=function(t){var t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return{r:t>>16,g:(65280&t)>>8,b:255&t}},a=function(t){return o(n(t))},o=function(t){var e={h:0,s:0,b:0},n=Math.min(t.r,t.g,t.b),a=Math.max(t.r,t.g,t.b),o=a-n;return e.b=a,e.s=0!=a?255*o/a:0,e.h=0!=e.s?t.r==a?(t.g-t.b)/o:t.g==a?2+(t.b-t.r)/o:4+(t.r-t.g)/o:-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e},i=function(t){var e={},n=t.h,a=255*t.s/100,o=255*t.b/100;if(0==a)e.r=e.g=e.b=o;else{var i=o,r=(255-a)*o/255,l=(i-r)*(n%60)/60;360==n&&(n=0),60>n?(e.r=i,e.b=r,e.g=r+l):120>n?(e.g=i,e.b=r,e.r=i-l):180>n?(e.g=i,e.r=r,e.b=r+l):240>n?(e.b=i,e.r=r,e.g=i-l):300>n?(e.b=i,e.g=r,e.r=r+l):360>n?(e.r=i,e.g=r,e.b=i-l):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}},r=function(e){var n=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.each(n,function(t,e){1==e.length&&(n[t]="0"+e)}),n.join("")},l=function(t){return r(i(t))};t.fn.extend({colpick:e.init,colpickHide:e.hidePicker,colpickShow:e.showPicker,colpickSetColor:e.setColor}),t.extend({colpick:{rgbToHex:r,rgbToHsb:o,hsbToHex:l,hsbToRgb:i,hexToHsb:a,hexToRgb:n}})
}(jQuery),function(t,e){e.bindingHandlers.wysiwyg={init:function(n,a){console.log("DEBUG: wysiwyg firing on: "+n);{var o=a(),i=e.computed({read:function(){return o.peek()[viewmodel.lang()]},write:function(t){var e=o.peek();e[viewmodel.lang()]=t,o.peek(e)}});t(n).summernote({onkeyup:function(){i(t(n).code())},toolbar:[["style",["style"]],["style",["bold","italic","underline","clear"]],["color",["color"]],["para",["paragraph"]]]})}t(n).code(i())},update:function(n,a){console.log("DEBUG: wysiwyg firing on: "+n);var o=a(),i=e.computed({read:function(){return o()[viewmodel.lang()]},write:function(t){var e=o();e[viewmodel.lang()]=t,o(e)}});t(n).code(i())}}}(jQuery,ko);